<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project-24: Learning Dominant Physical Processes using Data-Driven Balance Models: /Users/thomasbreitburd/Documents/CAMBRIDGE/Study/Project/tmb76/Scripts/geostrophic_balance.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Project-24: Learning Dominant Physical Processes using Data-Driven Balance Models
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4edcbb236dfd51dd81727243a38df6a0.html">Scripts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">geostrophic_balance.py File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This script applies the method of unsupervised dominant balance identification to a geophysical flow case, using oceanographic data.
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespace_scripts" id="r_namespace_scripts"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts.html">Scripts</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespace_scripts_1_1geostrophic__balance" id="r_namespace_scripts_1_1geostrophic__balance"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html">Scripts.geostrophic_balance</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad1627de9e3289581c9b2524325a4580c" id="r_ad1627de9e3289581c9b2524325a4580c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad1627de9e3289581c9b2524325a4580c">Scripts.geostrophic_balance.get_derivatives_numpy_geo</a> (<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">nx</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">ny</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2f4948e0a8494c09938820bd1d132c97">x</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa67826cc51157a2cb6b1e0c007ac2018">dy</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">v</a>)</td></tr>
<tr class="memdesc:ad1627de9e3289581c9b2524325a4580c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the derivatives for the 2D domain.  <br /></td></tr>
<tr class="separator:ad1627de9e3289581c9b2524325a4580c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb06b60a7482f6e921c0fdcefe23a4b4" id="r_adb06b60a7482f6e921c0fdcefe23a4b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#adb06b60a7482f6e921c0fdcefe23a4b4">Scripts.geostrophic_balance.spca_err</a> (<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe9eb8ba21e7ef4783a550d5bf89c758">alpha</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#abedcdc6896570fbe165c176263e64c51">cluster_idx</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a81294cae33f045be4e5dc6961a1b15aa">features</a>, nc)</td></tr>
<tr class="separator:adb06b60a7482f6e921c0fdcefe23a4b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa4a79e32ffa264e847c46d5bf8d843ed" id="r_aa4a79e32ffa264e847c46d5bf8d843ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa4a79e32ffa264e847c46d5bf8d843ed">Scripts.geostrophic_balance.cur_dir</a> = os.getcwd()</td></tr>
<tr class="separator:aa4a79e32ffa264e847c46d5bf8d843ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1ad8cfa0b978fc1764c403ff4cfd11" id="r_aec1ad8cfa0b978fc1764c403ff4cfd11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aec1ad8cfa0b978fc1764c403ff4cfd11">Scripts.geostrophic_balance.proj_dir</a> = os.path.dirname(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa4a79e32ffa264e847c46d5bf8d843ed">cur_dir</a>)</td></tr>
<tr class="separator:aec1ad8cfa0b978fc1764c403ff4cfd11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07965771640d7a14ca0e93644c48ed29" id="r_a07965771640d7a14ca0e93644c48ed29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a07965771640d7a14ca0e93644c48ed29">Scripts.geostrophic_balance.plots_dir</a> = os.path.join(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aec1ad8cfa0b978fc1764c403ff4cfd11">proj_dir</a>, &quot;Plots/Geos_Bal&quot;)</td></tr>
<tr class="separator:a07965771640d7a14ca0e93644c48ed29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313f5a6cdc153bfae0697917c95d1cc4" id="r_a313f5a6cdc153bfae0697917c95d1cc4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a313f5a6cdc153bfae0697917c95d1cc4">Scripts.geostrophic_balance.exist_ok</a></td></tr>
<tr class="separator:a313f5a6cdc153bfae0697917c95d1cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e3d35b1cdf5114b43949d12c555ce6" id="r_a82e3d35b1cdf5114b43949d12c555ce6"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a82e3d35b1cdf5114b43949d12c555ce6">Scripts.geostrophic_balance.path1</a> = &quot;../Data/hycom_gomu_501_1993010100_t000.nc&quot;</td></tr>
<tr class="separator:a82e3d35b1cdf5114b43949d12c555ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e7f9e6247e17d1a1c1f5907947e19e5" id="r_a5e7f9e6247e17d1a1c1f5907947e19e5"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a5e7f9e6247e17d1a1c1f5907947e19e5">Scripts.geostrophic_balance.path2</a> = &quot;../Data/hycom_gomu_501_1993010100_t003.nc&quot;</td></tr>
<tr class="separator:a5e7f9e6247e17d1a1c1f5907947e19e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be2847d5de3a8143829e224e92c0eb6" id="r_a0be2847d5de3a8143829e224e92c0eb6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a0be2847d5de3a8143829e224e92c0eb6">Scripts.geostrophic_balance.data_t1</a> = xr.open_dataset(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a82e3d35b1cdf5114b43949d12c555ce6">path1</a>, decode_times=False)</td></tr>
<tr class="separator:a0be2847d5de3a8143829e224e92c0eb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60eb979671017e7be11ccf47b4375c8e" id="r_a60eb979671017e7be11ccf47b4375c8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a60eb979671017e7be11ccf47b4375c8e">Scripts.geostrophic_balance.data_t2</a> = xr.open_dataset(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a5e7f9e6247e17d1a1c1f5907947e19e5">path2</a>, decode_times=False)</td></tr>
<tr class="separator:a60eb979671017e7be11ccf47b4375c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601352cfe849e34a6db037cca8d526d1" id="r_a601352cfe849e34a6db037cca8d526d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a601352cfe849e34a6db037cca8d526d1">Scripts.geostrophic_balance.lat</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a0be2847d5de3a8143829e224e92c0eb6">data_t1</a>[&quot;lat&quot;].values</td></tr>
<tr class="separator:a601352cfe849e34a6db037cca8d526d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06b9fee86d0ef4e82f7f87dff091e92d" id="r_a06b9fee86d0ef4e82f7f87dff091e92d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a06b9fee86d0ef4e82f7f87dff091e92d">Scripts.geostrophic_balance.lon</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a0be2847d5de3a8143829e224e92c0eb6">data_t1</a>[&quot;lon&quot;].values</td></tr>
<tr class="separator:a06b9fee86d0ef4e82f7f87dff091e92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306d951d1e5ec81e31e01ffba09b71ab" id="r_a306d951d1e5ec81e31e01ffba09b71ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">Scripts.geostrophic_balance.u</a> = np.array([<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a0be2847d5de3a8143829e224e92c0eb6">data_t1</a>[&quot;water_u&quot;].values, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a60eb979671017e7be11ccf47b4375c8e">data_t2</a>[&quot;water_u&quot;].values])</td></tr>
<tr class="separator:a306d951d1e5ec81e31e01ffba09b71ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11d4e869e6f8236730157e652a1f2014" id="r_a11d4e869e6f8236730157e652a1f2014"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">Scripts.geostrophic_balance.v</a> = np.array([<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a0be2847d5de3a8143829e224e92c0eb6">data_t1</a>[&quot;water_v&quot;].values, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a60eb979671017e7be11ccf47b4375c8e">data_t2</a>[&quot;water_v&quot;].values])</td></tr>
<tr class="separator:a11d4e869e6f8236730157e652a1f2014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0766a9983ab76dd48ec38a58db86bb" id="r_a7e0766a9983ab76dd48ec38a58db86bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">Scripts.geostrophic_balance.nx</a> = len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a06b9fee86d0ef4e82f7f87dff091e92d">lon</a>)</td></tr>
<tr class="separator:a7e0766a9983ab76dd48ec38a58db86bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe023e65189fb63bd59b8fc654274502" id="r_afe023e65189fb63bd59b8fc654274502"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">Scripts.geostrophic_balance.ny</a> = len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a601352cfe849e34a6db037cca8d526d1">lat</a>)</td></tr>
<tr class="separator:afe023e65189fb63bd59b8fc654274502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dae9c1277f638958c6ae78f4eb44b8a" id="r_a2dae9c1277f638958c6ae78f4eb44b8a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2dae9c1277f638958c6ae78f4eb44b8a">Scripts.geostrophic_balance.omega</a> = 7.29e-5</td></tr>
<tr class="separator:a2dae9c1277f638958c6ae78f4eb44b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae68675772d1a601d2f3a9614600750ae" id="r_ae68675772d1a601d2f3a9614600750ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae68675772d1a601d2f3a9614600750ae">Scripts.geostrophic_balance.f</a> = 2 * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2dae9c1277f638958c6ae78f4eb44b8a">omega</a> * np.sin(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a601352cfe849e34a6db037cca8d526d1">lat</a> * np.pi / 180)</td></tr>
<tr class="separator:ae68675772d1a601d2f3a9614600750ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a57768a273f5e2b93afa8881acea36" id="r_a20a57768a273f5e2b93afa8881acea36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a20a57768a273f5e2b93afa8881acea36">Scripts.geostrophic_balance.rho</a> = 1030</td></tr>
<tr class="separator:a20a57768a273f5e2b93afa8881acea36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c27eb1336702e740538f326623daea" id="r_ac3c27eb1336702e740538f326623daea"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ac3c27eb1336702e740538f326623daea">Scripts.geostrophic_balance.R</a> = 6.37e6</td></tr>
<tr class="separator:ac3c27eb1336702e740538f326623daea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8871a6bf9e8af93a6dd038abf1a5dad4" id="r_a8871a6bf9e8af93a6dd038abf1a5dad4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a8871a6bf9e8af93a6dd038abf1a5dad4">Scripts.geostrophic_balance.dt</a> = 3 * 3600</td></tr>
<tr class="separator:a8871a6bf9e8af93a6dd038abf1a5dad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc3218f0e8b344fc0a80252b630e9a1" id="r_a0bc3218f0e8b344fc0a80252b630e9a1"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a0bc3218f0e8b344fc0a80252b630e9a1">Scripts.geostrophic_balance.dx</a> = (1 / 25) * (1 / 360) * 2 * np.pi * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ac3c27eb1336702e740538f326623daea">R</a> * np.cos(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a601352cfe849e34a6db037cca8d526d1">lat</a> * np.pi / 180)</td></tr>
<tr class="separator:a0bc3218f0e8b344fc0a80252b630e9a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4948e0a8494c09938820bd1d132c97" id="r_a2f4948e0a8494c09938820bd1d132c97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2f4948e0a8494c09938820bd1d132c97">Scripts.geostrophic_balance.x</a> = np.zeros((<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">ny</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">nx</a>))</td></tr>
<tr class="separator:a2f4948e0a8494c09938820bd1d132c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa67826cc51157a2cb6b1e0c007ac2018" id="r_aa67826cc51157a2cb6b1e0c007ac2018"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa67826cc51157a2cb6b1e0c007ac2018">Scripts.geostrophic_balance.dy</a> = (1 / 25) * (1 / 360) * 2 * np.pi * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ac3c27eb1336702e740538f326623daea">R</a></td></tr>
<tr class="separator:aa67826cc51157a2cb6b1e0c007ac2018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf7529536bbcec05af550315e53fffa" id="r_aecf7529536bbcec05af550315e53fffa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aecf7529536bbcec05af550315e53fffa">Scripts.geostrophic_balance.u_x</a></td></tr>
<tr class="separator:aecf7529536bbcec05af550315e53fffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0c0535cec7811f18a70dd903e5b2c6c" id="r_ad0c0535cec7811f18a70dd903e5b2c6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad0c0535cec7811f18a70dd903e5b2c6c">Scripts.geostrophic_balance.u_y</a></td></tr>
<tr class="separator:ad0c0535cec7811f18a70dd903e5b2c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b483c199d2e3cdd201a5664715b4ec7" id="r_a7b483c199d2e3cdd201a5664715b4ec7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7b483c199d2e3cdd201a5664715b4ec7">Scripts.geostrophic_balance.v_x</a></td></tr>
<tr class="separator:a7b483c199d2e3cdd201a5664715b4ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1e338b294ac2aa1d702dcdd6b91444" id="r_a2d1e338b294ac2aa1d702dcdd6b91444"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2d1e338b294ac2aa1d702dcdd6b91444">Scripts.geostrophic_balance.v_y</a></td></tr>
<tr class="separator:a2d1e338b294ac2aa1d702dcdd6b91444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88252ed60f2b59d18b42384e58308f34" id="r_a88252ed60f2b59d18b42384e58308f34"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a88252ed60f2b59d18b42384e58308f34">Scripts.geostrophic_balance.u_t</a> = (<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[1] - <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0]) / <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a8871a6bf9e8af93a6dd038abf1a5dad4">dt</a></td></tr>
<tr class="separator:a88252ed60f2b59d18b42384e58308f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25c71d87c0c33c22f40f2d43dc9129f6" id="r_a25c71d87c0c33c22f40f2d43dc9129f6"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a25c71d87c0c33c22f40f2d43dc9129f6">Scripts.geostrophic_balance.v_t</a> = (<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">v</a>[1] - <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">v</a>[0]) / <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a8871a6bf9e8af93a6dd038abf1a5dad4">dt</a></td></tr>
<tr class="separator:a25c71d87c0c33c22f40f2d43dc9129f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9a1673ea97ac85cdcfc63831d4e155" id="r_a7b9a1673ea97ac85cdcfc63831d4e155"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7b9a1673ea97ac85cdcfc63831d4e155">Scripts.geostrophic_balance.u_grad_u</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0] * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aecf7529536bbcec05af550315e53fffa">u_x</a> + <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">v</a>[0] * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad0c0535cec7811f18a70dd903e5b2c6c">u_y</a></td></tr>
<tr class="separator:a7b9a1673ea97ac85cdcfc63831d4e155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82a8bc20b24e3018f3d9099c5651c992" id="r_a82a8bc20b24e3018f3d9099c5651c992"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a82a8bc20b24e3018f3d9099c5651c992">Scripts.geostrophic_balance.u_grad_v</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0] * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7b483c199d2e3cdd201a5664715b4ec7">v_x</a> + <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">v</a>[0] * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2d1e338b294ac2aa1d702dcdd6b91444">v_y</a></td></tr>
<tr class="separator:a82a8bc20b24e3018f3d9099c5651c992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88468fa199c8691224bc76af46106e3c" id="r_a88468fa199c8691224bc76af46106e3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a88468fa199c8691224bc76af46106e3c">Scripts.geostrophic_balance.f_u</a> = -<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae68675772d1a601d2f3a9614600750ae">f</a> * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0]</td></tr>
<tr class="separator:a88468fa199c8691224bc76af46106e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a04deca6a221fcf6476242c01ea287" id="r_a77a04deca6a221fcf6476242c01ea287"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a77a04deca6a221fcf6476242c01ea287">Scripts.geostrophic_balance.f_v</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae68675772d1a601d2f3a9614600750ae">f</a> * <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a11d4e869e6f8236730157e652a1f2014">v</a>[0]</td></tr>
<tr class="separator:a77a04deca6a221fcf6476242c01ea287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a798929214f861c759916a21dfb711b20" id="r_a798929214f861c759916a21dfb711b20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a798929214f861c759916a21dfb711b20">Scripts.geostrophic_balance.p_x</a> = -<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a20a57768a273f5e2b93afa8881acea36">rho</a> * (<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a88252ed60f2b59d18b42384e58308f34">u_t</a> + <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7b9a1673ea97ac85cdcfc63831d4e155">u_grad_u</a> + <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a77a04deca6a221fcf6476242c01ea287">f_v</a>)</td></tr>
<tr class="separator:a798929214f861c759916a21dfb711b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac20ee82ba79519980ad4b0163017c892" id="r_ac20ee82ba79519980ad4b0163017c892"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ac20ee82ba79519980ad4b0163017c892">Scripts.geostrophic_balance.p_y</a> = -<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a20a57768a273f5e2b93afa8881acea36">rho</a> * (<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a25c71d87c0c33c22f40f2d43dc9129f6">v_t</a> + <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a82a8bc20b24e3018f3d9099c5651c992">u_grad_v</a> + <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a88468fa199c8691224bc76af46106e3c">f_u</a>)</td></tr>
<tr class="separator:ac20ee82ba79519980ad4b0163017c892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2982ae7c1dff4cedcedde314080da69f" id="r_a2982ae7c1dff4cedcedde314080da69f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2982ae7c1dff4cedcedde314080da69f">Scripts.geostrophic_balance.features_mer</a></td></tr>
<tr class="separator:a2982ae7c1dff4cedcedde314080da69f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f6a5245543120a0e6453ac4721005c" id="r_a17f6a5245543120a0e6453ac4721005c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a17f6a5245543120a0e6453ac4721005c">Scripts.geostrophic_balance.features_zon</a></td></tr>
<tr class="separator:a17f6a5245543120a0e6453ac4721005c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67982c6007cb38b1ef78088ffc58c644" id="r_a67982c6007cb38b1ef78088ffc58c644"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a67982c6007cb38b1ef78088ffc58c644">Scripts.geostrophic_balance.nfeatures</a> = 4</td></tr>
<tr class="separator:a67982c6007cb38b1ef78088ffc58c644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748448f7fb243eae4c6f0ddc5864a260" id="r_a748448f7fb243eae4c6f0ddc5864a260"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a748448f7fb243eae4c6f0ddc5864a260">Scripts.geostrophic_balance.labels</a></td></tr>
<tr class="separator:a748448f7fb243eae4c6f0ddc5864a260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db0bd80a6233346a18ccc9e08f67e11" id="r_a1db0bd80a6233346a18ccc9e08f67e11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a1db0bd80a6233346a18ccc9e08f67e11">Scripts.geostrophic_balance.mer_nan</a> = np.isnan(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2982ae7c1dff4cedcedde314080da69f">features_mer</a>).any(axis=1)</td></tr>
<tr class="separator:a1db0bd80a6233346a18ccc9e08f67e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6971e9b6a1b4a3470e42298b43388662" id="r_a6971e9b6a1b4a3470e42298b43388662"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a6971e9b6a1b4a3470e42298b43388662">Scripts.geostrophic_balance.zon_nan</a> = np.isnan(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a17f6a5245543120a0e6453ac4721005c">features_zon</a>).any(axis=1)</td></tr>
<tr class="separator:a6971e9b6a1b4a3470e42298b43388662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81294cae33f045be4e5dc6961a1b15aa" id="r_a81294cae33f045be4e5dc6961a1b15aa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a81294cae33f045be4e5dc6961a1b15aa">Scripts.geostrophic_balance.features</a> = np.concatenate((<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2982ae7c1dff4cedcedde314080da69f">features_mer</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a17f6a5245543120a0e6453ac4721005c">features_zon</a>), axis=0)</td></tr>
<tr class="separator:a81294cae33f045be4e5dc6961a1b15aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae89a6f88a513081f17b4b20945d2e7f1" id="r_ae89a6f88a513081f17b4b20945d2e7f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae89a6f88a513081f17b4b20945d2e7f1">Scripts.geostrophic_balance.seed</a> = 75016</td></tr>
<tr class="separator:ae89a6f88a513081f17b4b20945d2e7f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c45fb15e40f8cad772e50d0488b8d04" id="r_a2c45fb15e40f8cad772e50d0488b8d04"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2c45fb15e40f8cad772e50d0488b8d04">Scripts.geostrophic_balance.frac</a> = 0.5</td></tr>
<tr class="separator:a2c45fb15e40f8cad772e50d0488b8d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1702c7bc6eebfc05ed84930939479fee" id="r_a1702c7bc6eebfc05ed84930939479fee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a1702c7bc6eebfc05ed84930939479fee">Scripts.geostrophic_balance.features_train</a></td></tr>
<tr class="separator:a1702c7bc6eebfc05ed84930939479fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59304098e7270381fc91c20a207a5104" id="r_a59304098e7270381fc91c20a207a5104"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a59304098e7270381fc91c20a207a5104">Scripts.geostrophic_balance._</a></td></tr>
<tr class="separator:a59304098e7270381fc91c20a207a5104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad672428252d0b055c9164854a741763f" id="r_ad672428252d0b055c9164854a741763f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad672428252d0b055c9164854a741763f">Scripts.geostrophic_balance.train_size</a></td></tr>
<tr class="separator:ad672428252d0b055c9164854a741763f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629a4754656656fc0ba5b020eb249500" id="r_a629a4754656656fc0ba5b020eb249500"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a629a4754656656fc0ba5b020eb249500">Scripts.geostrophic_balance.random_state</a></td></tr>
<tr class="separator:a629a4754656656fc0ba5b020eb249500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099a49a427c95b87b4bd195e071a3a2e" id="r_a099a49a427c95b87b4bd195e071a3a2e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a099a49a427c95b87b4bd195e071a3a2e">Scripts.geostrophic_balance.n_clusters</a> = int(sys.argv[1])</td></tr>
<tr class="separator:a099a49a427c95b87b4bd195e071a3a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c776ccf1c4339edd2723ff00684c05" id="r_ab6c776ccf1c4339edd2723ff00684c05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ab6c776ccf1c4339edd2723ff00684c05">Scripts.geostrophic_balance.model</a> = GaussianMixture(n_components=<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a099a49a427c95b87b4bd195e071a3a2e">n_clusters</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a629a4754656656fc0ba5b020eb249500">random_state</a>=<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae89a6f88a513081f17b4b20945d2e7f1">seed</a>)</td></tr>
<tr class="separator:ab6c776ccf1c4339edd2723ff00684c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedcdc6896570fbe165c176263e64c51" id="r_abedcdc6896570fbe165c176263e64c51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#abedcdc6896570fbe165c176263e64c51">Scripts.geostrophic_balance.cluster_idx</a> = model.predict(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a81294cae33f045be4e5dc6961a1b15aa">features</a>)</td></tr>
<tr class="separator:abedcdc6896570fbe165c176263e64c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2961791cdc7eafe8bb5426d910fb28e" id="r_ae2961791cdc7eafe8bb5426d910fb28e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae2961791cdc7eafe8bb5426d910fb28e">Scripts.geostrophic_balance.n_meridional</a> = len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a2982ae7c1dff4cedcedde314080da69f">features_mer</a>[:, 0])</td></tr>
<tr class="separator:ae2961791cdc7eafe8bb5426d910fb28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a269f0a4bd30dd51492c2c1ee6e6e30b0" id="r_a269f0a4bd30dd51492c2c1ee6e6e30b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a269f0a4bd30dd51492c2c1ee6e6e30b0">Scripts.geostrophic_balance.cluster_idx_mer</a> = np.zeros(len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0, :, :].flatten()))</td></tr>
<tr class="separator:a269f0a4bd30dd51492c2c1ee6e6e30b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97d2d9af4c36e02b05c4333e680b778" id="r_ab97d2d9af4c36e02b05c4333e680b778"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ab97d2d9af4c36e02b05c4333e680b778">Scripts.geostrophic_balance.cluster_idx_zon</a> = np.zeros(len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0, :, :].flatten()))</td></tr>
<tr class="separator:ab97d2d9af4c36e02b05c4333e680b778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefaa89d2e95c98fae511746d06b17d48" id="r_aefaa89d2e95c98fae511746d06b17d48"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aefaa89d2e95c98fae511746d06b17d48">Scripts.geostrophic_balance.clustermap_mer</a> = cluster_idx_mer.reshape(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">ny</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">nx</a>)</td></tr>
<tr class="separator:aefaa89d2e95c98fae511746d06b17d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee81f965eacd0cfc68d97764fa0f390" id="r_a6ee81f965eacd0cfc68d97764fa0f390"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a6ee81f965eacd0cfc68d97764fa0f390">Scripts.geostrophic_balance.clustermap_zon</a> = cluster_idx_zon.reshape(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">ny</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">nx</a>)</td></tr>
<tr class="separator:a6ee81f965eacd0cfc68d97764fa0f390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad88369031642aa4b6bce0b66dec3a0bd" id="r_ad88369031642aa4b6bce0b66dec3a0bd"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad88369031642aa4b6bce0b66dec3a0bd">Scripts.geostrophic_balance.alphas</a> = [1e-4, 1e-3, 1e-2, 0.1, 1, 10, 100, 1e3, 1e4, 1e5]</td></tr>
<tr class="separator:ad88369031642aa4b6bce0b66dec3a0bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5eb12877562d64583508ef8dd58d582" id="r_ad5eb12877562d64583508ef8dd58d582"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad5eb12877562d64583508ef8dd58d582">Scripts.geostrophic_balance.err</a> = np.zeros([len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ad88369031642aa4b6bce0b66dec3a0bd">alphas</a>)])</td></tr>
<tr class="separator:ad5eb12877562d64583508ef8dd58d582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9eb8ba21e7ef4783a550d5bf89c758" id="r_afe9eb8ba21e7ef4783a550d5bf89c758"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe9eb8ba21e7ef4783a550d5bf89c758">Scripts.geostrophic_balance.alpha</a> = float(sys.argv[2])</td></tr>
<tr class="separator:afe9eb8ba21e7ef4783a550d5bf89c758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa08a2569b5fa8b78df95a0323fdb3c50" id="r_aa08a2569b5fa8b78df95a0323fdb3c50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa08a2569b5fa8b78df95a0323fdb3c50">Scripts.geostrophic_balance.spca_model</a> = np.zeros((<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a099a49a427c95b87b4bd195e071a3a2e">n_clusters</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a67982c6007cb38b1ef78088ffc58c644">nfeatures</a>))</td></tr>
<tr class="separator:aa08a2569b5fa8b78df95a0323fdb3c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5901653110a7c0191e09ef8c45a98ccc" id="r_a5901653110a7c0191e09ef8c45a98ccc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a5901653110a7c0191e09ef8c45a98ccc">Scripts.geostrophic_balance.feature_idx</a> = np.where(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#abedcdc6896570fbe165c176263e64c51">cluster_idx</a> == i)[0]</td></tr>
<tr class="separator:a5901653110a7c0191e09ef8c45a98ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ecbd8891ba5e3daee9b769d5d2d2ef" id="r_a62ecbd8891ba5e3daee9b769d5d2d2ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a62ecbd8891ba5e3daee9b769d5d2d2ef">Scripts.geostrophic_balance.cluster_features</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a81294cae33f045be4e5dc6961a1b15aa">features</a>[<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a5901653110a7c0191e09ef8c45a98ccc">feature_idx</a>, :]</td></tr>
<tr class="separator:a62ecbd8891ba5e3daee9b769d5d2d2ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98eb0f3d57ea480b3c6d50ed19a02017" id="r_a98eb0f3d57ea480b3c6d50ed19a02017"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a98eb0f3d57ea480b3c6d50ed19a02017">Scripts.geostrophic_balance.spca</a> = SparsePCA(n_components=1, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe9eb8ba21e7ef4783a550d5bf89c758">alpha</a>=<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe9eb8ba21e7ef4783a550d5bf89c758">alpha</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a629a4754656656fc0ba5b020eb249500">random_state</a>=<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae89a6f88a513081f17b4b20945d2e7f1">seed</a>)</td></tr>
<tr class="separator:a98eb0f3d57ea480b3c6d50ed19a02017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b40468962db420c758716247650625" id="r_aa0b40468962db420c758716247650625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa0b40468962db420c758716247650625">Scripts.geostrophic_balance.active_terms</a> = np.where(spca.components_[0] != 0)[0]</td></tr>
<tr class="separator:aa0b40468962db420c758716247650625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afafec56e88fcd2e45cde4455ab5563d1" id="r_afafec56e88fcd2e45cde4455ab5563d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afafec56e88fcd2e45cde4455ab5563d1">Scripts.geostrophic_balance.spca_temp</a> = pd.DataFrame(spca_model.copy())</td></tr>
<tr class="separator:afafec56e88fcd2e45cde4455ab5563d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbeaebb135c251755e5861bf7011ef6" id="r_a3dbeaebb135c251755e5861bf7011ef6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a3dbeaebb135c251755e5861bf7011ef6">Scripts.geostrophic_balance.grouped_models</a> = spca_temp.groupby(np.arange(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a67982c6007cb38b1ef78088ffc58c644">nfeatures</a>).tolist())</td></tr>
<tr class="separator:a3dbeaebb135c251755e5861bf7011ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929711f5562531c152455ed52e067251" id="r_a929711f5562531c152455ed52e067251"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a929711f5562531c152455ed52e067251">Scripts.geostrophic_balance.balance_models</a> = pd.DataFrame(np.zeros((len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a3dbeaebb135c251755e5861bf7011ef6">grouped_models</a>), <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a67982c6007cb38b1ef78088ffc58c644">nfeatures</a>)))</td></tr>
<tr class="separator:a929711f5562531c152455ed52e067251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c5d3adf4448c1e35b617363be67e04" id="r_a55c5d3adf4448c1e35b617363be67e04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a55c5d3adf4448c1e35b617363be67e04">Scripts.geostrophic_balance.model_idx</a> = np.zeros(len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aa08a2569b5fa8b78df95a0323fdb3c50">spca_model</a>), dtype=int)</td></tr>
<tr class="separator:a55c5d3adf4448c1e35b617363be67e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a880424886ad4fef37fa900a035662925" id="r_a880424886ad4fef37fa900a035662925"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a880424886ad4fef37fa900a035662925">Scripts.geostrophic_balance.idx</a> = <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ab6c776ccf1c4339edd2723ff00684c05">model</a>[1].to_list()</td></tr>
<tr class="separator:a880424886ad4fef37fa900a035662925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5600cdd5eb7017860fe37beb1c2ab670" id="r_a5600cdd5eb7017860fe37beb1c2ab670"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a5600cdd5eb7017860fe37beb1c2ab670">Scripts.geostrophic_balance.nmodels</a> = balance_models.shape[0]</td></tr>
<tr class="separator:a5600cdd5eb7017860fe37beb1c2ab670"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefbc7345471275fb38dfc28b46c83134" id="r_aefbc7345471275fb38dfc28b46c83134"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#aefbc7345471275fb38dfc28b46c83134">Scripts.geostrophic_balance.balance_idx</a> = np.array([<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a55c5d3adf4448c1e35b617363be67e04">model_idx</a>[i] for i in <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#abedcdc6896570fbe165c176263e64c51">cluster_idx</a>])</td></tr>
<tr class="separator:aefbc7345471275fb38dfc28b46c83134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa5c394f6a713842739bb390dc66f14" id="r_a1aa5c394f6a713842739bb390dc66f14"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a1aa5c394f6a713842739bb390dc66f14">Scripts.geostrophic_balance.balance_idx_mer</a> = np.zeros(len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0].flatten()))</td></tr>
<tr class="separator:a1aa5c394f6a713842739bb390dc66f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660ba631ed66b47f5c76762969f8286f" id="r_a660ba631ed66b47f5c76762969f8286f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a660ba631ed66b47f5c76762969f8286f">Scripts.geostrophic_balance.balance_idx_zon</a> = np.zeros(len(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a306d951d1e5ec81e31e01ffba09b71ab">u</a>[0].flatten()))</td></tr>
<tr class="separator:a660ba631ed66b47f5c76762969f8286f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b5a57d4759346591888610e2c13182" id="r_ae2b5a57d4759346591888610e2c13182"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#ae2b5a57d4759346591888610e2c13182">Scripts.geostrophic_balance.balancemap_mer</a> = balance_idx_mer.reshape(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">ny</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">nx</a>)</td></tr>
<tr class="separator:ae2b5a57d4759346591888610e2c13182"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb7220acf5ab35bdb65a410131df2cc" id="r_a8fb7220acf5ab35bdb65a410131df2cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a8fb7220acf5ab35bdb65a410131df2cc">Scripts.geostrophic_balance.balancemap_zon</a> = balance_idx_zon.reshape(<a class="el" href="namespace_scripts_1_1geostrophic__balance.html#afe023e65189fb63bd59b8fc654274502">ny</a>, <a class="el" href="namespace_scripts_1_1geostrophic__balance.html#a7e0766a9983ab76dd48ec38a58db86bb">nx</a>)</td></tr>
<tr class="separator:a8fb7220acf5ab35bdb65a410131df2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This script applies the method of unsupervised dominant balance identification to a geophysical flow case, using oceanographic data. </p>
<p>This code makes the use of the code in the turbulent boundary layer notebook/script, using some of the alternate code. More importantly, only the information in the paper and paper's supplementary information was used to write this, alongside the already written code (boundary layer).</p>
<p>The script performs the following steps:</p><ul>
<li>Load the data obtained from the HYCOM database.</li>
<li>Calculate spatial and temporal derivatives of the velocity field.</li>
<li>Define features representing terms in the governing equations.</li>
<li>Cluster the data using Gaussian Mixture Models (GMM).</li>
<li>Apply Sparse Principal Component Analysis (SPCA) to identify active terms in each cluster.</li>
<li>Validate the balance models and plot the results.</li>
</ul>
<p>The script takes 2 arguments:</p><ul>
<li>The number of clusters to use in the GMM, any non-zero positive integer.</li>
<li>The optimal alpha value for the SPCA, any non-zero positive float.</li>
</ul>
<p>The script outputs the result plots to the 'Plots/Geos_Bal/' directory.</p>
<dl class="section author"><dt>Author</dt><dd>T. Breitburd, with some code from Callaham et al. (2021) </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
